<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    
    <!-- Google Analytics -->
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1HJJPVBRH3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-1HJJPVBRH3');
    </script>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Sredna Skorost BG">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Sredna Skorost BG">
    <meta name="theme-color" content="#1976D2">
    <meta name="msapplication-navbutton-color" content="#1976D2">
    <meta name="msapplication-TileColor" content="#1976D2">
    <meta name="msapplication-starturl" content="/">
    
    <!-- PWA Description -->
    <meta name="description" content="–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª –Ω–∞ —Å—Ä–µ–¥–Ω–∞—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç –ø–æ –±—ä–ª–≥–∞—Ä—Å–∫–∏—Ç–µ –º–∞–≥–∏—Å—Ç—Ä–∞–ª–∏ A1/E80">
    <meta name="keywords" content="—Å–∫–æ—Ä–æ—Å—Ç, –º–∞–≥–∏—Å—Ç—Ä–∞–ª–∞, –ê1, –ï80, –ë—ä–ª–≥–∞—Ä–∏—è, speed, highway, monitoring">
    
    <title>Sredna Skorost BG</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicons and App Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="512x512" href="favicon-512x512.png">
    <link rel="apple-touch-icon" sizes="192x192" href="icons/Icon-192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="favicon-512x512.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <div id="map"></div>
    

    <div class="speed-display">
        <div class="speed-row">
            <div class="speed-item">
                <div class="speed-label">–¢–µ–∫—É—â–∞ —Å–∫–æ—Ä–æ—Å—Ç</div>
                <div class="speed-value" id="current-speed">0.0 –∫–º/—á</div>
            </div>
            <div class="speed-item">
                <div class="speed-label">–°—Ä–µ–¥–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç</div>
                <div class="speed-value" id="average-speed">0.0 –∫–º/—á</div>
            </div>
        </div>
        
        <div class="info-box">
            <div class="info-row">
                <span>–ü—Ä–æ–≥–Ω–æ–∑–Ω–∞ —Å—Ä–µ–¥–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç:</span>
                <span id="predicted-speed">0.0 –∫–º/—á</span>
            </div>
            <div class="info-row">
                <span>–ò–∑–º–∏–Ω–∞—Ç–æ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ:</span>
                <span id="distance">0.0 –∫–º</span>
            </div>
            <div class="info-row" id="direction-row" style="display: none;">
                <span>–ü–æ—Å–æ–∫–∞ –Ω–∞ –¥–≤–∏–∂–µ–Ω–∏–µ:</span>
                <span id="current-direction">--</span>
            </div>
            <div class="info-row" style="font-size: 12px; color: #666; text-align: center;">
                <span>–ú–∞–≥–∏—Å—Ç—Ä–∞–ª–∞ A1/E80: –í–∞–∫–∞—Ä–µ–ª ‚Üí –¢—Ä–∏–ª–∏—Å—Ç–Ω–∏–∫</span>
            </div>
        </div>
        
        <!-- Auto-guidance panel - always visible -->
        <div class="auto-guidance-box" id="auto-guidance-box">
            <div class="auto-guidance-header">
                <span class="auto-guidance-icon">ü§ñ</span>
                <span class="auto-guidance-label">–ü—Ä–µ–ø–æ—Ä—ä–∫–∞ –∑–∞ —Å–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –ª–∏–º–∏—Ç–∞</span>
            </div>
            <div class="auto-guidance-content">
                <div class="auto-guidance-target">
                    <span>–ö–∞—Ä–∞–π—Ç–µ –¥–æ: </span>
                    <span id="auto-target-speed" class="target-speed">--</span>
                    <span id="auto-target-reason" class="target-reason">–∑–∞ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ –∑–∞–∫–æ–Ω–Ω–∞ —Å—Ä–µ–¥–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç 140 –∫–º/—á</span>
                </div>
                <div class="auto-guidance-status" id="auto-guidance-status">
                    –ò–∑—á–∞–∫–≤–∞–Ω–µ –∑–∞ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ
                </div>
            </div>
        </div>
        
    </div>
    
    <div class="control-buttons">
        <button id="tracking-btn" onclick="toggleTracking()">
            <span id="btn-icon">‚ñ∂</span>
            <span id="btn-text">–ó–∞–ø–æ—á–Ω–∏</span>
        </button>
        <button id="force-zone-btn" onclick="forceZoneDetection()" style="display: none;">
            <span id="zone-btn-icon">üéØ</span>
            <span id="zone-btn-text">–ù–∞–º–µ—Ä–∏ –∑–æ–Ω–∞</span>
        </button>
        <button id="pause-btn" onclick="togglePause()" style="display: none;">
            <span id="pause-icon">‚è∏Ô∏è</span>
            <span id="pause-text">–ü–∞—É–∑–∞</span>
        </button>
        <button id="history-btn" onclick="showSessionHistory()" style="display: block;">
            <span>üìö</span>
            <span>–ò—Å—Ç–æ—Ä–∏—è</span>
        </button>
    </div>
    
    <!-- Session History Modal -->
    <div id="session-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ò—Å—Ç–æ—Ä–∏—è –Ω–∞ —Å–µ—Å–∏–∏—Ç–µ</h3>
                <button onclick="closeSessionModal()">‚úï</button>
            </div>
            <div id="session-list"></div>
        </div>
    </div>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(function(registration) {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('PWA install prompt available');
        });
    </script>
</body>
</html>